<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/background.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Assistance Reservation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-image: url('images/airline_bg.jpg');
            background-size: cover;
            background-position: center;
            font-family: Arial, sans-serif;
        }
        .container_bag {
            top: 50%;
            max-width: 400px;
            background: white;
            padding: 20px;
            margin: 120px auto 20px; 
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            background-color: rgba(151, 149, 149, 0.4);
            border-radius: 10px;
        }
        .name {
            position: absolute;
            right: 0%;
        }
        select, input, .calculate-btn, .pay-btn {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            border: 2px solid #000000;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .calculate-btn {
            background-color: #007bff;
            color: white;
        }
        .calculate-btn:hover {
            background-color: #0056b3;
        }
        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #007bff;
            padding: 15px;
            color: white;
        }
        .navbar .logo {
            height: 50px;
        }
        .navbar .nav-links {
            display: flex;
            gap: 15px;
        }
        .nav-links a {
            text-decoration: none;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
        }
        .nav-links a:hover {
            background-color: #0056b3;
        }
        .dropdown {
            position: absolute;
            left: 20%;
            width: 50px;
            border-radius: 20px;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: rgba(231, 230, 230, 0.4);
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            z-index: 1;
            border-radius: 5px;
            overflow: hidden;
            transition: all 0.3s ease;
            opacity: 0; 
            visibility: hidden;
            transform: translateY(-10px);
        }
        .dropdown:hover .dropdown-content {
            display: block;
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .dropdown-content a {
            display: block;
            padding: 12px 16px;
            color: #333;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s ease, padding-left 0.3s ease;
        }
        .dropdown-content a:hover {
            background-color: rgba(143, 143, 143, 0.4);
            color: #000000;
            padding-left: 20px;
        }
        .dropdown > a {
            text-decoration: none;
            color: #000000;
            font-size: 18px;
            padding: 12px;
            font-weight: bold;
            display: inline-block;
            transition: color 0.3s ease;
        }
        .dropdown > a:hover {
            color: #333333;
        }
        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #007bff;
            padding: 15px;
            color: white;
        }
        .navbar .logo {
            height: 50px;
        }
        .dropdown-content a:hover {
            background-color: rgba(143, 143, 143, 0.4);
            color: #000000;
            padding-left: 20px;
        }
        .bag_bg {
            position: fixed; 
            top: 0;
            left: 0;
            width: 100%;
            height: 100%; 
            background-image: url('images/bg_register.png');
            background-size: cover; 
            background-position: center;
            z-index: -1;
        }
        /* Tailwind-enhanced form styles */
        .form-container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 0.5rem;
            padding: 1.5rem;
            max-width: 32rem;
            width: 100%;
            margin-top: 5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-radius: 0.375rem;
            border: 2px solid #000;
            font-size: 1rem;
        }
        .form-submit {
            width: 100%;
            padding: 0.75rem;
            background-color: #2563eb;
            color: white;
            font-weight: bold;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }
        .form-submit:hover {
            background-color: #1d4ed8;
        }
        .form-submit:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">
    <img class="bag_bg" src="images/homepage_background.jpg" alt="">
    <div class="header w-full">
        <img class="logo" src="images/air_logo.png">
        <p class="name">CLOUDTRIP</p>
        <div class="buttons">
            <a href="login_page.html"><button class="login_button">Login</button></a>
            <a href="index.html"><button class="home_button">Home</button></a>
            <a href="about_page.html"><button class="about_button">About</button></a>
            
        </div>
        <div class="dropdown">
            <a href="#">Prime Facilities</a>
            <div class="dropdown-content">
                <a href="lounge.html">VIP Lounge</a>
                <a href="entertainment.html">Entertainment Package</a>
                <a href="baggage.html">Baggage Fee Estimator</a>
                <a href="fare.html">Fare Prediction</a>
            </div>
        </div>
    </div>

    <div class="form-container">
        <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">✈️ Special Assistance Reservation</h2>
        
        <form id="assistanceForm" class="space-y-4">
            <!-- Passenger Name -->
            <div>
                <label class="block font-medium text-gray-700">Full Name</label>
                <input name="fullName" type="text" placeholder="Enter your full name" required
                    class="form-input">
            </div>
            
            <!-- Email -->
            <div>
                <label class="block font-medium text-gray-700">Email Address</label>
                <input name="email" type="email" placeholder="Enter your email" required
                    class="form-input">
            </div>
            
            <!-- Contact Number -->
            <div>
                <label class="block font-medium text-gray-700">Contact Number</label>
                <input name="contactNumber" type="tel" placeholder="Enter your contact number" required
                    class="form-input">
            </div>
            
            <!-- Select Disability Type -->
            <div>
                <label class="block font-medium text-gray-700">Type of Disability</label>
                <select name="disabilityType" class="form-input">
                    <option value="">-- Select --</option>
                    <option value="visual">Visual Impairment</option>
                    <option value="hearing">Hearing Impairment</option>
                    <option value="mobility">Mobility Impairment</option>
                    <option value="other">Other</option>
                </select>
            </div>
            
            <!-- Wheelchair Assistance -->
            <div>
                <label class="block font-medium text-gray-700">Wheelchair Assistance</label>
                <div class="flex flex-wrap gap-3">
                    <label class="flex items-center space-x-2">
                        <input name="wheelchairDeparture" type="checkbox" class="form-checkbox text-blue-500" value="true">
                        <span>Departure</span>
                    </label>
                    <label class="flex items-center space-x-2">
                        <input name="wheelchairArrival" type="checkbox" class="form-checkbox text-blue-500" value="true">
                        <span>Arrival</span>
                    </label>
                    <label class="flex items-center space-x-2">
                        <input name="wheelchairLayover" type="checkbox" class="form-checkbox text-blue-500" value="true">
                        <span>Layover</span>
                    </label>
                </div>
            </div>
            
            <!-- Priority Boarding -->
            <div>
                <label class="block font-medium text-gray-700">Priority Boarding</label>
                <select name="priorityBoarding" class="form-input">
                    <option value="">-- Select --</option>
                    <option value="yes">Yes, I need early boarding</option>
                    <option value="no">No, I'll board normally</option>
                </select>
            </div>
            
            <!-- Emergency Contact -->
            <div>
                <label class="block font-medium text-gray-700">Emergency Contact Name</label>
                <input name="emergencyContactName" type="text" placeholder="Enter emergency contact name" required
                    class="form-input">
            </div>
            
            <div>
                <label class="block font-medium text-gray-700">Emergency Contact Number</label>
                <input name="emergencyContactNumber" type="tel" placeholder="Enter emergency contact number" required
                    class="form-input">
            </div>
            
            <!-- Submit Button -->
            <button type="submit" class="form-submit">
                Submit Request
            </button>
        </form>
    </div>

    <script type="module">
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
        
        // Initialize Supabase
        const supabase = createClient(
          "https://psvfacqymwdovnjnhowo.supabase.co",
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBzdmZhY3F5bXdkb3Zuam5ob3dvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI3MzI1NDYsImV4cCI6MjA1ODMwODU0Nn0.Q2s9rR30QQUkdZ02YM2HJyGWfB3I9omST4n2gEUqLic"
        );
        
        document.getElementById('assistanceForm').addEventListener('submit', async (e) => {
          e.preventDefault();
          const button = e.target.querySelector('button[type="submit"]');
          const originalText = button.textContent;
          
          try {
            button.disabled = true;
            button.innerHTML = 'Submitting <span class="animate-pulse">...</span>';
            
            const formData = {
              full_name: e.target.elements.fullName.value,
              email: e.target.elements.email.value,
              contact_number: e.target.elements.contactNumber.value,
              disability_type: e.target.elements.disabilityType.value,
              wheelchair_departure: e.target.elements.wheelchairDeparture.checked,
              wheelchair_arrival: e.target.elements.wheelchairArrival.checked,
              wheelchair_layover: e.target.elements.wheelchairLayover.checked,
              priority_boarding: e.target.elements.priorityBoarding.value,
              emergency_contact_name: e.target.elements.emergencyContactName.value,
              emergency_contact_number: e.target.elements.emergencyContactNumber.value
            };
        
            const { error } = await supabase
              .from('special_pass')
              .insert([formData]);
        
            if (error) throw error;
            
            alert("Request submitted successfully!");
            window.location.href = "baggage.html";
            e.target.reset();
            
          } catch (error) {
            console.error("Error:", error);
            alert("Error: " + error.message);
          } finally {
            button.disabled = false;
            button.textContent = originalText;
          }
        });
    </script>
</body>
</html>